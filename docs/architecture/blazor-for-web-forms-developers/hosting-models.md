---
title: Blazor アプリホスティングモデル
description: Blazor アプリをホストするさまざまな方法について説明します。これには、ブラウザーで、またはサーバー上でも含まれます。
author: danroth27
ms.author: daroth
ms.date: 09/11/2019
ms.openlocfilehash: 5bf55fa686691acc25508d3d9a6dfaf8aca321ca
ms.sourcegitcommit: 559fcfbe4871636494870a8b716bf7325df34ac5
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/30/2019
ms.locfileid: "73841949"
---
# <a name="blazor-app-hosting-models"></a>Blazor アプリホスティングモデル

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

Blazor アプリは、ASP.NET Web フォームアプリと同様に IIS でホストできます。 Blazor アプリは、次のいずれかの方法でホストすることもできます。

- ブラウザーでのクライアント側のブラウザー。
- ASP.NET Core アプリのサーバー側。

## <a name="blazor-webassembly-apps"></a>Blazor Webasアプリ

Blazor webassembly は、ブラウザーで直接実行される .NET ランタイムによって直接実行されます。 Blazor WebAssembly は、角度や反応などのフロントエンド JavaScript フレームワークと同様の方法で機能します。 ただし、JavaScript を記述するのでC#はなく、記述します。 .NET ランタイムは、アプリアセンブリおよび必要な依存関係と共に、アプリと共にダウンロードされます。 ブラウザープラグインまたは拡張機能は必要ありません。

ダウンロードしたアセンブリは、他の .NET アプリで使用するのと同じように、通常の .NET アセンブリです。 ランタイムでは .NET Standard がサポートされているため、既存の .NET Standard ライブラリを Blazor WebAssembly で使用できます。 ただし、これらのアセンブリは引き続きブラウザーのセキュリティサンドボックスで実行されます。 一部の機能では、ファイルシステムにアクセスしたり、任意のネットワーク接続を開いたりするなど、<xref:System.PlatformNotSupportedException>がスローされる場合があります。

アプリが読み込まれると、.NET ランタイムが開始され、アプリケーションアセンブリで参照されます。 アプリのスタートアップロジックが実行され、ルートコンポーネントがレンダリングされます。 Blazor は、コンポーネントからのレンダリングされた出力に基づいて、UI の更新を計算します。 その後、DOM の更新が適用されます。

![Blazor WebAssembly](media/hosting-models/blazor-webassembly.png)

Blazor WebAssembly は、純粋にクライアント側で実行します。 このようなアプリは、GitHub ページや Azure の静的な Web サイトのホスティングなどの静的サイトホスティングソリューションにデプロイできます。 .NET は、サーバーでは必要ありません。 通常、アプリの一部に対するディープリンクには、サーバー上のルーティングソリューションが必要です。 ルーティングソリューションは、要求をアプリのルートにリダイレクトします。 たとえば、このリダイレクトは、IIS の URL 書き換えルールを使用して処理できます。

Blazor とフルスタック .NET web 開発のすべての利点を得るには、ASP.NET Core で Blazor Webas アプリをホストします。 クライアントとサーバーの両方で .NET を使用することにより、コードを簡単に共有し、1つの一貫した言語、フレームワーク、ツールのセットを使用してアプリをビルドできます。 Blazor には、Blazor Webasapp と ASP.NET Core host プロジェクトの両方を含むソリューションを設定するための便利なテンプレートが用意されています。 ソリューションをビルドすると、Blazor アプリから構築された静的ファイルは、フォールバックルーティングが既に設定されている ASP.NET Core アプリによってホストされます。

## <a name="blazor-server-apps"></a>Blazor サーバーアプリ

[Blazor アーキテクチャ](architecture-comparison.md#blazor)の議論を思い出してください。 Blazor コンポーネントは、出力を `RenderTree`と呼ばれる中間の抽象化にレンダリングします。 次に、Blazor フレームワークは、レンダリングされた内容を以前にレンダリングしたものと比較します。 違いは DOM に適用されます。 Blazor コンポーネントは、レンダリングされた出力の適用方法から切り離されています。 そのため、コンポーネント自体は、UI を更新するプロセスと同じプロセスで実行する必要はありません。 実際、同じコンピューターで実行する必要もありません。

Blazor Server apps では、コンポーネントはブラウザーでクライアント側ではなくサーバー上で実行されます。 ブラウザーで発生した UI イベントは、リアルタイム接続を介してサーバーに送信されます。 イベントは、正しいコンポーネントインスタンスにディスパッチされます。 コンポーネントがレンダリングされ、計算された UI diff がシリアル化され、DOM に適用されるブラウザーに送信されます。

![Blazor サーバー](media/hosting-models/blazor-server.png)

Blazor サーバーホスティングモデルは、ASP.NET AJAX と <xref:System.Web.UI.UpdatePanel> コントロールを使用している場合は、よく知られている可能性があります。 `UpdatePanel` コントロールは、ページ上のトリガーイベントに応じて部分ページ更新の適用を処理します。 トリガーされると、`UpdatePanel` が部分的な更新を要求し、ページを更新せずに適用します。 UI の状態は `ViewState`を使用して管理されます。 Blazor サーバーアプリは、アプリがクライアントとのアクティブな接続を必要とすると若干異なります。 また、すべての UI の状態はサーバー上で保持されます。 これらの違いを除けば、2つのモデルは概念的に似ています。

## <a name="how-to-choose-the-right-blazor-hosting-model"></a>適切 Blazor ホスティングモデルを選択する方法

[Blazor ホスティングモデル](https://docs.microsoft.com/aspnet/core/blazor/hosting-models#server-side)に関するドキュメントで説明されているように、異なる Blazor ホスティングモデルではトレードオフが異なります。

Blazor WebAssembly ホスティングモデルには、次の利点があります。

- .NET サーバー側の依存関係はありません。 クライアントにダウンロードされた後、アプリは完全に機能しています。
- クライアントのリソースと機能は完全に活用されています。
- 作業はサーバーからクライアントにオフロードされます。
- アプリケーションをホストするために ASP.NET Core web サーバーは必要ありません。 サーバーレスの展開シナリオが可能です (たとえば、CDN からアプリを提供するなど)。

Blazor WebAssembly ホスティングモデルの欠点は次のとおりです。

- ブラウザーの機能によってアプリが制限されます。
- サポートされているクライアントハードウェアとソフトウェア (たとえば、WebAssembly サポート) が必要です。
- ダウンロードサイズが大きくなり、アプリの読み込みに時間がかかります。
- .NET ランタイムとツールのサポートの成熟度は低くなります。 たとえば、 [.NET Standard](../../standard/net-standard.md)のサポートとデバッグには制限があります。

逆に、Blazor サーバーホスティングモデルには、次のような利点があります。

- ダウンロードサイズはクライアント側アプリよりもはるかに小さく、アプリの読み込みにかかる時間が大幅に短縮されます。
- このアプリでは、.NET Core と互換性のある Api の使用を含め、サーバーの機能を最大限に活用できます。
- サーバー上の .NET Core はアプリを実行するために使用されるため、デバッグなどの既存の .NET ツールは想定どおりに動作します。
- シンクライアントがサポートされています。 たとえば、サーバー側のアプリは、WebAssembly サポートされていないブラウザーや、リソースが制限されたデバイスで動作します。
- アプリのコンポーネントコードをC#含む、アプリの .net/コードベースはクライアントに提供されません。

Blazor サーバーホスティングモデルの欠点は次のとおりです。

- UI の待機時間が長くなります。 すべてのユーザーの操作には、ネットワークホップが関係します。
- オフラインサポートはありません。 クライアント接続が失敗した場合、アプリは動作を停止します。
- 多くのユーザーがいるアプリでは、スケーラビリティが困難です。 サーバーは、複数のクライアント接続を管理し、クライアントの状態を処理する必要があります。
- アプリを提供するには、ASP.NET Core サーバーが必要です。 サーバーレス展開シナリオは使用できません。 たとえば、CDN からアプリを提供することはできません。

上記のトレードオフの一覧は、厄介な場合がありますが、ホスティングモデルは後で変更できます。 選択した Blazor ホスティングモデルに関係なく、コンポーネントモデルは*同じ*です。 原則として、同じコンポーネントをいずれのホストモデルでも使用できます。 アプリのコードは変わりません。ただし、コンポーネントがモデルに依存しないホストを維持するために、抽象化を導入することをお勧めします。 抽象化により、アプリは別のホスティングモデルをより簡単に導入できます。

## <a name="deploy-your-app"></a>アプリを配置する

ASP.NET Web フォームアプリは、通常、Windows Server コンピューターまたはクラスター上の IIS でホストされます。 Blazor アプリでも次のことが可能です。

- 静的ファイルまたは ASP.NET Core アプリとして IIS でホストされます。
- ASP.NET Core の柔軟性を活用して、さまざまなプラットフォームやサーバーインフラストラクチャでホストすることができます。 たとえば、Linux で[Nginx](/aspnet/core/host-and-deploy/linux-nginx)または[Apache](/aspnet/core/host-and-deploy/linux-apache)を使用して Blazor アプリをホストできます。 Blazor アプリを発行してデプロイする方法の詳細については、Blazor[ホスティングおよびデプロイ](/aspnet/core/host-and-deploy/blazor/)に関するドキュメントを参照してください。

次のセクションでは、Blazor WebAssembly と Blazor Server アプリのプロジェクトがどのように設定されているかについて説明します。

>[!div class="step-by-step"]
>[前へ](architecture-comparison.md)
>[次へ](project-structure.md)
