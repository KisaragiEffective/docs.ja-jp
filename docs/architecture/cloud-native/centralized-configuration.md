---
title: 集中管理構成
description: Azure Key Vault を使用した一元化された構成によって、クラウドネイティブアプリの管理が容易になります。
ms.date: 06/30/2019
ms.openlocfilehash: 4c516b6773d913acd71ff06742302e9766a141e2
ms.sourcegitcommit: 56f1d1203d0075a461a10a301459d3aa452f4f47
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/24/2019
ms.locfileid: "73841139"
---
# <a name="centralized-configuration"></a>集中管理構成

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

クラウドネイティブアプリケーションには、従来の単一インスタンスモノリシックアプリよりも多くのサービスが実行されています。 多数の相互に依存するサービスの構成設定を管理することは困難な場合があります。これは、多くの場合、集中管理された構成ストアが分散アプリケーションに実装されるためです。

[第1章](introduction.md)で説明したように、12要素アプリの推奨事項では、コードと構成を厳密に分離する必要があります。 これは、構成設定を定数またはリテラル値としてコードに格納することが違反になることを意味します。 この推奨事項が存在するのは、開発、テスト、ステージング、運用など、複数の環境で同じコードを使用する必要があるためです。 ただし、構成値は、これらの環境によって異なる可能性があります。 そのため、構成値は環境自体に保存する必要があります。そうしないと、環境は一元的な構成ストアに資格情報を保存する必要があります。

EShopOnContainers アプリケーションには、各マイクロサービスにローカルアプリケーション設定ファイルが含まれています。 これらのファイルはソース管理にチェックインされますが、接続文字列や API キーなどの運用シークレットは含まれません。 運用環境では、個々の設定がサービスごとの環境変数で上書きされる可能性があります。 これは、ホストされているアプリケーションの一般的な方法ですが、中央の構成ストアは提供しません。 構成設定の一元管理をサポートするために、各マイクロサービスには、ローカル設定または Azure Key Vault 設定の使用を切り替えるための設定が含まれています。

## <a name="azure-key-vault"></a>Azure Key Vault

Azure Key Vault は、トークン、パスワード、証明書、API キー、およびその他の機密情報を安全に格納します。 Key Vault にアクセスするには、適切な呼び出し元の認証と承認が必要です。これは eShopOnContainers マイクロサービスの場合、ClientId/ClientSecret の組み合わせを使用することを意味します。 これらの資格情報をソース管理にチェックインするのではなく、アプリケーションの環境で設定します。 AKS から Key Vault への直接アクセスは、 [FlexVolume Key Vault](https://github.com/Azure/kubernetes-keyvault-flexvol)使用して実現できます。

集中管理された構成では、一元化されたログエンドポイントなど、アプリケーション全体に適用される設定を1回だけ設定し、分散アプリケーションのすべての部分で使用できます。 マイクロサービスは互いに独立している必要がありますが、通常は、構成の詳細が集中管理された構成ストアの利点を持つ共有依存関係があります。

>[!div class="step-by-step"]
>[前へ](deploy-eshoponcontainers-azure.md)
>[次へ](scale-applications.md)
