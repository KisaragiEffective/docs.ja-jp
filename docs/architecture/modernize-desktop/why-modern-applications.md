---
title: デスクトップ アプリを最新化する理由
description: 最新の世界における Windows フォーム、WPF、UWP などのデスクトップテクノロジについて説明します。
ms.date: 12/29/2020
ms.openlocfilehash: 8489e41c973bb472a23bca38e9374c36e4cdd366
ms.sourcegitcommit: 632818f4b527e5bf3c48fc04e0c7f3b4bdb8a248
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/20/2021
ms.locfileid: "98615894"
---
# <a name="why-modern-desktop-applications"></a>デスクトップ アプリを最新化する理由

## <a name="introduction"></a>はじめに

### <a name="a-story-of-one-company"></a>1社のストーリー

2000年の前半では、企業のさまざまなブランチ間で情報を交換し、一元化されたユニットで最適化された操作を実行する分散デスクトップソリューションの開発を開始しました。 アプリケーション開発のために、Windows フォーム (WinForms とも呼ばれます) と呼ばれる新しいフレームワークを選択しました。 長年にわたり、プロジェクトは、数百ものコードを含む、成熟した、十分にテストされた、時間のかかる実績のあるアプリケーションに発展しました。 経過時間と .NET Framework 2.0 は、新たに導入されたテクノロジではなくなりました。 このアプリケーションで作業している開発者は、ジレンマに直面しています。 開発時に最新のテクノロジを使用して、アプリケーションの外観と "感覚" を最新のものにしたいと考えています。 同時に、15年を超えて構築された優れた製品を捨てて、アプリケーション全体をゼロから書き直す必要はありません。

### <a name="your-story"></a>お話

長年にわたって信頼性が実証されている Windows フォームまたは Windows Presentation Foundation (WPF) アプリケーションがある同じボートにいる場合があります。 多くの場合、これらのアプリケーションを長年にわたって使用することをお勧めします。 同時に、これらのアプリケーションは少し前に記述されていたため、最新の外観、パフォーマンス、新しいデバイスとプラットフォームの機能との統合などの機能が不足している可能性があります。これにより、"古い技術" の感覚が得られます。 他にも、開発者として懸念される問題があります。 以前の .NET Framework バージョンで作業していて、その前に作成されたアプリケーションを維持しているときに、新しいテクノロジを学習したり、最新の技術的スキルを構築したりすることはできません。 そのような場合は、こちらの記事をお探しください。

## <a name="desktop-applications-nowadays"></a>今日のデスクトップアプリケーション

インターネットの開始前に、デスクトップアプリケーションはソフトウェアシステムを構築するための主なアプローチでした。 開発者は、COBOL、Fortran、VB6、C++ など、任意のプログラミング言語を選択できます。 しかし、小規模ツールまたは複雑な分散アーキテクチャを開発したのは、すべてのデスクトップアプリケーションでした。

次に、インターネットテクノロジは、開発環境の shocking を開始し、より簡単な展開と簡略化された配布プロセスといった利点がある、より多くのエンジニアを獲得しました。 Web アプリケーションが運用環境にデプロイされると、すべてのユーザーが自動更新を行ったことにより、ソフトウェアの機敏性に大きな影響が及びました。

ただし、インターネットインフラストラクチャ、基になるプロトコル、HTTP や HTML などの標準は、複雑なアプリケーションを構築するように設計されていません。 実際、主要な開発作業は、データの高速入力や状態管理など、デスクトップアプリケーションと同じ機能を web アプリケーションに提供することを目的としたものでした。

Web アプリケーションやモバイルアプリケーションが非常に優れたペースで拡張された場合でも、デスクトップアプリケーションでは、効率性とパフォーマンスの面で1つの場所を保持します。 ここでは、WPF と WinForms を使用してプロジェクトをビルドする何百万もの開発者がいて、それらのアプリケーションの量が絶えず拡大している理由について説明します。

ここでは、開発環境でデスクトップアプリケーションを選択する理由をいくつか示します。

- デスクトップアプリは、ユーザーの PC との対話に適しています。
- 複雑な計算におけるデスクトップアプリケーションのパフォーマンスは、web アプリケーションのパフォーマンスよりも大幅に高くなります。
- クライアント側でカスタムロジックを実行することは可能ですが、web アプリケーションでは非常に困難です。
- デスクトップアプリケーションでは、マルチスレッドを使用する方が簡単で効率的です。
- ユーザーインターフェイス (Ui) を設計するための学習曲線は、あまり急旋回されていません。 また、WinForms では、Windows フォームデザイナーのドラッグアンドドロップ操作で直感的に使用できます。
- サーバーインフラストラクチャを設定したり、接続の問題、ファイアウォール、ブラウザーの互換性を考慮したりすることなく、アルゴリズムのコーディングとテストを簡単に開始できます。
- デバッグは、web デバッグと比べて強力です。
- カメラ、Bluetooth、カードリーダーなどのハードウェアデバイスへのアクセスは簡単です。
- このテクノロジはしばらくの間に行われているため、多くの専門家と、デスクトップアプリケーションの開発に使用できるナレッジベースがあります。

ご覧のように、デスクトップ向けの開発は多くの理由で非常に優れています。 このテクノロジは成熟しており、時間がかかり、開発サイクルが高速で、デバッグが強力であり、デスクトップアプリの複雑さが少なく、使いやすくなりました。

Microsoft では、1995で導入された Win32 から、2016でリリースされたユニバーサル Windows プラットフォーム (UWP) まで、多くの UI デスクトップテクノロジを提供してきました。

![Microsoft デスクトップテクノロジ](./media/why-modern-applications/microsoft-desktop-technologies.png)

2016年4月に Telerik によって発行されたアンケートによれば、Windows デスクトップアプリを構築するための最も一般的なテクノロジは Windows フォーム、WPF、UWP です。

![最も一般的なデスクトップテクノロジとして Windows フォーム、WPF、UWP を示すアンケート](./media/why-modern-applications/telerik-survey.png)

C# と Visual Basic を使用してこれらのいずれかで開発できますが、詳しく見ていきましょう。

### <a name="windows-forms"></a>Windows フォーム

2002で最初にリリースされた Windows フォームはマネージフレームワークであり、Windows graphics device interface (GDI) エンジン上に構築された最も古い、最も使用されているデスクトップテクノロジです。 Visual Studio でユーザーインターフェイスを開発するための、スムーズなドラッグアンドドロップエクスペリエンスを提供します。  同時に、Windows フォームは、UI を開発する主な方法として Visual Studio デザイナーに依存しているため、コードからビジュアルコンポーネントを作成するのは簡単ではありません。

次の一覧は、Windows フォームの主な特性をまとめたものです。

- 多くのコードサンプルとドキュメントを含む成熟したテクノロジ。
- 強力で生産性の高いデザイナー。 UI をコードから設計するのは便利ではありません。
- デザイナーのドラッグアンドドロップ操作により、簡単かつ直感的に学習できます。
- Windows のすべてのバージョンでサポートされています。
- .NET Core 3.0 以降のバージョンでサポートされています。

### <a name="wpf"></a>WPF

WPF は、XAML 言語仕様に基づき、UI とコードを明確に分離することを優先します。 XAML には、大規模なアプリケーションの構築に適したテンプレート、スタイル、バインドなどの機能が用意されています。 Windows フォームと同様に、これはマネージフレームワークですが、設計はモジュール型で再利用可能です。

WPF の主な機能を次に示します。

- 完成度の高いテクノロジ
- デザイナーは使用できますが、通常、開発者は宣言型の XAML を使用してコードからデザインを作成することをお勧めします。
- 学習曲線は Windows フォームよりも勾配が上がります。
- Windows のすべてのバージョンでサポートされています。
- .NET Core 3.0 以降のバージョンでサポートされています。

### <a name="uwp"></a>UWP

UWP は WPF や Windows フォームのようなプレゼンテーションフレームワークであるだけでなく、プラットフォーム自体でもあります。 このプラットフォームには次のものがあります。

- 独自の API セット (Windows ランタイム API)。
- 新しい展開システム (MSIX)
- 最新のアプリケーションライフサイクルモデル (バッテリ使用量が少ない場合)。
- 新しいリソース管理システム (PRI ファイルに基づく)。

このプラットフォームは、すべての種類の入力システム (インク、タッチ、ゲームパッド、マウス、キーボード、宝石など) をサポートするために作成されており、パフォーマンスとバッテリ使用量が少ないことを念頭に置いています。 これらの理由から、Windows 10 OS のシェルは UWP プラットフォームの一部を使用します。

![UWP 構造体](./media/why-modern-applications/uwp-structure.png)

UWP には、WPF などの XAML ベースのプレゼンテーションフレームワークが含まれていますが、次のようないくつかの重要な違いがあります。

- アプリケーションは、アプリコンテナーで実行されます。 アプリコンテナーは、UWP アプリがアクセスできるリソースを制御します。
- Windows 10 でのみサポートされます。
- アプリは、展開を容易にするために Microsoft Store を使用して展開できます。
- Windows ランタイム API の一部として設計されています。
- には、多数の豊富な組み込みコントロールと、Microsoft UI ライブラリ NuGet パッケージ (WinUI ライブラリ) から数か月前に更新された追加のコントロールが含まれています。

## <a name="a-tale-of-two-platforms"></a>2つのプラットフォームの tale of two

過去20年間、UI デスクトップテクノロジは、Windows フォームから UWP へのパスに発展してきましたが、ハードウェアは、小さな CRT モニターを搭載したヘビーウェイト PC ユニットから高 DPI モニターに進化し、タッチやインクなどのさまざまなデータ入力手法を備えた軽量のタブレットや携帯電話にも発展していました。 これらの変更によって、デスクトップアプリケーションとモダンアプリケーションという2つの異なる概念が作成されました。 最新のアプリケーションは、さまざまなデバイスのフォームファクター、さまざまな入力および出力方法を考慮し、サンドボックス実行モデルで実行中の最新のデスクトップ機能を活用します。 一方、(従来の) デスクトップアプリケーションは、マウスとキーボードを使用して最適に操作できる、高密度のコントロールを備えたソリッド UI が必要なアプリケーションです。

次の表では、2つの概念の違いについて説明します。

|   | モダンアプリケーション | デスクトップアプリケーション |
| --- | --- | --- |
| Security | 実行に関する優れた基礎が含ま &amp; れています。 ユーザーのプライバシーを尊重し、バッテリの寿命を管理し、デバイスの安全を維持するために、一から設計されています。  | ユーザー &amp; 管理者レベルのセキュリティ。 レジストリとハードドライブフォルダーにネイティブでアクセスできます。 |
| デプロイ | インストールと更新はプラットフォームによって管理されます。   | MSI、カスタムインストーラーの &amp; 更新。 従来は、開発者や IT 管理者にとって、悩みの原因になっていました。  |
| Distribution | 信頼さ &amp; れた配布の署名付きパッケージ。 配布は信頼できるソースから実行され、web からは実行されません。  | Web、SCCM &amp; カスタム配布。 インストールされる内容を制御することはできません。コンピューター全体に影響します。   |
| UI | モダン UI。 さまざまな入力メカニズム、インク、タッチ、ゲームパッド、キーボード、マウスなど。  | Windows フォーム、WPF、MFC。 マウスとキーボードを使用して、細かい UI を作成し、デスクトップの生産性を最大限に高めるように設計されています。  |
| Data | 洞察を含むクラウドの最初のデータ。 クラウド内の真実の源。 アプリの動作とその実行方法を把握するための洞察。  | ローカルデータ。 従来のデスクトップアプリケーションでは、通常、一部のローカルデータが必要です。  |
| デザイン | 再利用できるように設計されています。 さまざまなプラットフォーム、フロントエンド、バックエンド間での再利用を念頭に置いて、さまざまな場所で資産を実行できます。  | Windows デスクトップのみ向けに設計されています  |

開発者がアプリケーションを構築するための最適なツールを提供するための取り組みの一環として、Microsoft はこれらの概念を実現するための大きな取り組みを行っています。または、プラットフォームについても詳しく説明して、開発者が両方の世界を最大限に活用できるようにします。 これを行うために、Microsoft は2つのプラットフォーム間で双方向の取り組みを行っています。

![最新のアプリケーションとデスクトップアプリケーションの間の双方向作業](./media/why-modern-applications/bidirectional-effort.png)

1. デスクトップアプリケーションのシナリオを最新のアプリケーションプラットフォームに移動します。 従来のデスクトップ開発は、特定のシナリオに適切に対処するため、引き続き人気のあるものです。 これらの一般的なデスクトップシナリオを利用して、プラットフォームを完全に機能させるために最新のデスクトッププラットフォームに持ち込むことが理にかなっています。

    ![デスクトップアプリケーションのシナリオを最新のアプリケーションプラットフォームに移動する](./media/why-modern-applications/desktop-to-modern.png)

1. 最新のアプリケーション機能をデスクトップアプリケーションに移動します。 最初から書き換えずに最新の機能を利用する方法を必要とする既存のデスクトップアプリでは、最新のアプリケーションプラットフォームの機能がデスクトップアプリケーションにプッシュされます。

    ![最新のアプリケーション機能をデスクトップアプリケーションに移行する](./media/why-modern-applications/modern-to-desktop.png)

この書籍では、2番目の部分に注目し、既存のデスクトップアプリケーションを最新化する方法について説明します。

## <a name="paths-to-modernization"></a>最新化へのパス

このガイドの構造は、最新の機能、展開、およびインストールを実現する3つの異なる軸を反映しています。

### <a name="modern-features"></a>最新の機能

たとえば、会社の営業担当者がを使用して顧客の注文を入力する作業 Windows フォームアプリケーションがあるとします。 ユーザーがタブレットペンを使用して注文に署名できるようにするための新しい要件が用意されています。 現在のオペレーティングシステムとテクノロジでは、インクはネイティブですが、アプリの開発時には利用できませんでした。

このパスでは、最新のデスクトップ機能を活用して既存のデスクトップ開発を行う方法について説明します。

### <a name="deployment"></a>デプロイ

最新の開発サイクルでは、アプリケーションの新しいバージョンをすべてのユーザーに展開する際の機敏性が向上しています。 Windows フォームと WPF のアプリケーションは、コンピューター上に存在する必要がある .NET Framework の特定のバージョンに基づいているため、同じコンピューターで実行されている他のアプリに対して副作用が生じるリスクがある場合でも、新しい .NET Framework バージョンの機能を利用することはできません。 これは、開発者が .NET Framework の古いバージョンを維持することを強制するイノベーションペースを制限しています。

.NET Core 3.0 の起動以降、複数のバージョンの .NET を並行してデプロイし、各アプリケーションが対象とする .NET のバージョンを指定する新しいアプローチを利用できます。 こうすることで、1つのアプリケーションで最新の機能を使用しながら、他のアプリケーションに侵入することを確実にすることができます。

### <a name="installation"></a>インストール

デスクトップアプリケーションは、ユーザーが使用を開始する前に、何らかのインストールプロセスに依存します。 これにより、MSI と ClickOnce からカスタムインストーラーや XCOPY 配置まで、一連のテクノロジがゲームに導入されています。 これらの方法では、アプリケーションがコンピューター上の共有リソースにアクセスする方法を必要とするため、微妙な問題が発生します。 場合によっては、新しいキー値を挿入または更新するためにレジストリにアクセスする必要があります。メインアプリケーションで参照されている共有 Dll を更新することもあります。 この動作により、ユーザーにとって継続的な悩みが発生します。アプリケーションをインストールすると、後でアンインストールしても、コンピューターが同じになることはありません。

この書籍では、前に説明した問題を解決する MSIX を使用してアプリケーションをインストールする新しい方法を紹介します。 アプリケーションのパッケージ化、インストール、および更新を簡単にセットアップする方法について説明します。

>[!div class="step-by-step"]
>[前へ](index.md)
>[次へ](whats-new-dotnet.md)
