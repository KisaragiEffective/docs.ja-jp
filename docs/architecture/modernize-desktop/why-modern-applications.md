---
title: デスクトップ アプリを最新化する理由
description: モダン世界における Windows フォーム、WPF、UWP などのデスクトップ テクノロジについて説明します。
ms.date: 12/29/2020
ms.openlocfilehash: 8489e41c973bb472a23bca38e9374c36e4cdd366
ms.sourcegitcommit: 05d0087dfca85aac9ca2960f86c5efd218bf833f
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/30/2021
ms.locfileid: "98615894"
---
# <a name="why-modern-desktop-applications"></a>デスクトップ アプリを最新化する理由

## <a name="introduction"></a>はじめに

### <a name="a-story-of-one-company"></a>ある企業のストーリー

2000 年の初頭に、ある多国籍企業が、企業のさまざまなブランチ間で情報を交換し、一元化されたユニットで最適化された操作を実行するための分散デスクトップ ソリューションの開発を開始しました。 アプリケーション開発のために、Windows フォーム (WinForms とも呼ばれます) と呼ばれるまったく新しいフレームワークを選択しました。 年を追って、プロジェクトは数十万行ものコードを含む、成熟した、十分にテストされた、実績のあるアプリケーションに発展しました。 時が経ち、.NET Framework 2.0 は最新のテクノロジではなくなりました。 このアプリケーションに取り組んでいる開発者は、ジレンマに直面しています。 開発に最新のテクノロジを使用して、アプリケーションの外観と "感覚" をモダンにしたいと考えています。 同時に、15 年かけて構築してきた優れた製品を捨てて、アプリケーション全体をゼロから書き直すことは望んでいません。

### <a name="your-story"></a>あなたのストーリー

あなたも同じ状況にあるかもしれません。Windows フォームまたは Windows Presentation Foundation (WPF) アプリケーションを成熟させてきて、その信頼性は長年にわたって実証されています。 おそらく、今後何年にもわたってこれらのアプリケーションを使用したいと考えるでしょう。 同時に、これらのアプリケーションは少し前に作成されたため、モダンな外観、パフォーマンス、新しいデバイスやプラットフォームの機能との統合といった機能が不足している可能性があり、"古い技術" の印象を与えます。 開発者として懸念される問題がもう 1 つあります。 古い .NET Framework バージョンで作業し、しばらく前に作成されたアプリケーションを保守していると、新しいテクノロジを習得していないように感じ、最新の技術的スキルを構築する機会を逃していると感じるかもしれません。 そのようなあなたには、本書をお勧めします。

## <a name="desktop-applications-nowadays"></a>今日のデスクトップ アプリケーション

インターネットが台頭する前は、デスクトップ アプリケーションはソフトウェア システムを構築するための主なアプローチでした。 開発者は、COBOL、Fortran、VB6、C++ など、任意のプログラミング言語を選択できました。 しかし、開発していたものが小規模なツールか複雑な分散アーキテクチャかにかかわらず、それらはすべてデスクトップ アプリケーションでした。

その後、インターネット テクノロジが開発の世界に衝撃を与え、より簡単なデプロイと簡略化された配布プロセスなどの利点によって、より多くのエンジニアを獲得し始めました。 Web アプリケーションがいったん運用環境にデプロイされればすべてのユーザーが自動更新を受け取るという事実は、ソフトウェアの機敏性に大きな影響を与えました。

ただし、インターネット インフラストラクチャ、基になるプロトコル、および HTTP や HTML などの標準は、複雑なアプリケーションの構築用には設計されていませんでした。 実際、その当時の主な開発作業は、1 つのことだけを目標にしていました。それは、データの高速入力や状態管理など、デスクトップ アプリケーションと同じ機能を Web アプリケーションに与えることです。

Web アプリケーションやモバイル アプリケーションは信じられないような速さで拡大してきましたが、特定のタスクでは、デスクトップ アプリケーションが効率性とパフォーマンスの面で今でも 1 位を占めています。 この理由により、何百万もの開発者が WPF と WinForms を使用してプロジェクトを構築しており、そのようなアプリケーションの量は絶えず増加しています。

ここでは、開発環境でデスクトップ アプリケーションを選択する理由をいくつか示します。

- ユーザーの PC との対話にはデスクトップ アプリの方が適しています。
- 複雑な計算におけるデスクトップ アプリケーションのパフォーマンスは、Web アプリケーションのパフォーマンスよりも大幅に高くなります。
- Web アプリケーションでは、クライアント側でカスタム ロジックを実行することは可能ですが、はるかに難しくなります。
- デスクトップ アプリケーションでは、マルチスレッドをより簡単で効率的に使用できます。
- ユーザー インターフェイス (UI) を設計するための学習曲線が急勾配ではありません。 また、WinForms は、Windows フォーム デザイナーのドラッグ アンド ドロップ操作で直感的に使用できます。
- サーバー インフラストラクチャを設定したり、接続の問題、ファイアウォール、ブラウザーの互換性を考慮したりする必要がなく、アルゴリズムのコーディングとテストを簡単に開始できます。
- Web デバッグと比べてデバッグが強力です。
- カメラ、Bluetooth、カード リーダーなどのハードウェア デバイスへのアクセスが簡単です。
- このテクノロジは以前から存在しているため、多くの専門家とナレッジ ベースをデスクトップ アプリケーションの開発に利用できます。

したがって、おわかりのように、デスクトップ向けの開発は多くの理由で非常に優れています。 このテクノロジは成熟して実績があり、開発サイクルは高速で、デバッグは強力です。またおそらく、デスクトップ アプリはそれほど複雑ではなく、より簡単に使い始めることができます。

Microsoft では、1995 年に導入された Win32 から、2016 年にリリースされたユニバーサル Windows プラットフォーム (UWP) まで、多くの UI デスクトップ テクノロジを提供してきました。

![Microsoft のデスクトップ テクノロジ](./media/why-modern-applications/microsoft-desktop-technologies.png)

2016 年 4 月に Telerik によって発表されたアンケートによれば、Windows デスクトップ アプリを構築するための最も人気の高いテクノロジは Windows フォーム、WPF、UWP です。

![最も人気の高いデスクトップ テクノロジとして Windows フォーム、WPF、UWP が示されている Telerik のアンケート](./media/why-modern-applications/telerik-survey.png)

C# と Visual Basic を使用してこれらのいずれかで開発できますが、詳しく見ていきましょう。

### <a name="windows-forms"></a>Windows フォーム

2002 年に初めてリリースされた Windows フォームは、マネージド フレームワークであり、Windows グラフィックス デバイス インターフェイス (GDI) エンジン上に構築された最も古い、最も使用されているデスクトップ テクノロジです。 Visual Studio でユーザー インターフェイスを開発するための、スムーズなドラッグ アンド ドロップ操作を提供します。  同時に、Windows フォームは、UI を開発する主な方法として Visual Studio デザイナーに依存しているため、コードからビジュアル コンポーネントを作成するのは簡単ではありません。

次の一覧は、Windows フォームの主な特徴をまとめたものです。

- 多くのコード サンプルとドキュメントが存在する成熟したテクノロジ。
- 強力で生産性の高いデザイナー。 UI を "コードから" 設計するのは便利ではありません。
- デザイナーのドラッグ アンド ドロップ操作により、簡単かつ直感的に学習できます。
- Windows のすべてのバージョンでサポートされています。
- .NET Core 3.0 以降のバージョンでサポートされています。

### <a name="wpf"></a>WPF

WPF は、XAML 言語仕様に基づき、UI とコードの明確な分離に役立ちます。 XAML には、大規模なアプリケーションの構築に適したテンプレート、スタイル指定、バインディングなどの機能が用意されています。 Windows フォームと同様に、これはマネージド フレームワークですが、設計はモジュール型で再利用可能です。

WPF の主な機能は次のとおりです。

- 完成度の高いテクノロジ
- デザイナーを使用できますが、開発者は通常、宣言型の XAML を使用してコードからデザインを作成する方を好みます。
- 学習曲線は Windows フォームよりも急勾配になります。
- Windows のすべてのバージョンでサポートされています。
- .NET Core 3.0 以降のバージョンでサポートされています。

### <a name="uwp"></a>UWP

UWP は、WPF や Windows フォームのようなプレゼンテーション フレームワークであるだけでなく、プラットフォームそのものでもあります。 このプラットフォームには次のものがあります。

- 独自の API セット (Windows ランタイム API)。
- 新しいデプロイ システム (MSIX)
- モダン アプリケーション ライフサイクル モデル (バッテリ消費の低減のため)。
- 新しいリソース管理システム (PRI ファイルに基づく)。

このプラットフォームは、すべてのフォーム ファクターですべての種類の入力システム (インク、タッチ、ゲームパッド、マウス、キーボード、視線など) をサポートするために、パフォーマンスとバッテリ消費低減を考慮して作成されています。 これらの理由から、Windows 10 OS のシェルでは UWP プラットフォームの一部分が使用されます。

![UWP の構造](./media/why-modern-applications/uwp-structure.png)

UWP には、WPF のような XAML ベースのプレゼンテーション フレームワークが含まれていますが、次のようないくつかの重要な違いがあります。

- アプリケーションは、アプリ コンテナーで実行されます。 アプリ コンテナーは、UWP アプリがアクセスできるリソースを制御します。
- Windows 10 でのみサポートされています。
- アプリは、デプロイを容易にするために Microsoft Store からデプロイできます。
- Windows ランタイム API の一部として設計されています。
- 幅広く豊富な組み込みコントロールと、Microsoft UI ライブラリ NuGet パッケージ (WinUI ライブラリ) から入手でき数か月ごとに更新される追加のコントロールが含まれています。

## <a name="a-tale-of-two-platforms"></a>2 つのプラットフォームの物語

過去 20 年間、UI デスクトップ テクノロジは Windows フォームから UWP へと発展してきました。ハードウェアもまた、小さな CRT モニターを備えた重い PC ユニットから、高 DPI モニターと軽量のタブレットや携帯電話、タッチやインクなどのさまざまなデータ入力技術を備えたものに進化してきました。 これらの変化によって、デスクトップ アプリケーションとモダン アプリケーションという 2 つの異なる概念が生まれました。 モダン アプリケーションは、さまざまなデバイスのフォームファクターやさまざまな入力および出力方法を考慮し、モダン デスクトップ機能を活用して、サンドボックス実行モデルで実行されます。 一方、(従来の) デスクトップ アプリケーションは、マウスとキーボードによって最適に操作できる、高密度のコントロールを備えたソリッド UI を必要とするアプリケーションです。

次の表は、2 つの概念の違いについて説明しています。

|   | モダン アプリケーション | デスクトップ アプリケーション |
| --- | --- | --- |
| セキュリティ | 抑制された実行と優れた基盤。 ユーザーのプライバシーを尊重し、バッテリの寿命を管理し、デバイスの安全を維持するように、一から設計されています。  | ユーザーと管理者レベルのセキュリティ。 レジストリとハード ドライブ フォルダーにネイティブでアクセスできます。 |
| デプロイ | インストールと更新はプラットフォームによって管理されます。   | MSI、カスタム インストーラー、更新プログラム。 従来は、開発者や IT 管理者にとって悩みの種でした。  |
| Distribution | 信頼された配布と署名済みパッケージ。 配布は信頼できるソースから実行され、Web からは実行されません。  | Web、SCCM、およびカスタム配布。 インストールされる内容を制御することはできません。コンピューター全体に影響します。   |
| UI | モダン UI。 さまざまな入力メカニズム、インク、タッチ、ゲームパッド、キーボード、マウスなど。  | Windows フォーム、WPF、MFC。 高密度 UI にマウスとキーボードを使用し、デスクトップの生産性を最大限に高めるように設計されています。  |
| Data | 分析情報を含むクラウド ファーストのデータ。 クラウド内の信頼できる情報源。 アプリで発生していることや実行状態を把握するための分析情報。  | ローカル データ。 従来のデスクトップ アプリケーションには、通常、何らかのローカル データが必要です。  |
| デザイン | 再利用できるように設計されています。 さまざまなプラットフォーム、フロントエンド、バックエンドの間での再利用を考慮して、できるだけ多くの場所で資産を運用します。  | Windows デスクトップ専用に設計されています  |

アプリケーションを構築するための最適なツールを開発者に提供する取り組みの一環として、Microsoft では、これらの概念 (プラットフォームと呼んでもよいでしょう) を互いに近づけ、開発者が両方の世界を最大限に活用できるようにしようと取り組んでいます。 そのために、Microsoft では 2 つのプラットフォーム間で双方向の取り組みを行ってきました。

![モダン アプリケーションとデスクトップ アプリケーションの間の双方向作業](./media/why-modern-applications/bidirectional-effort.png)

1. デスクトップ アプリケーションのシナリオをモダン アプリケーション プラットフォームに移動します。 従来のデスクトップ開発は、特定のシナリオに適切に対処するため、引き続き人気のあるものです。 これらの一般的なデスクトップ シナリオをモダン デスクトップ プラットフォームに取り込んで、完全な機能を備えたプラットフォームにすることは理にかなっています。

    ![デスクトップ アプリケーションのシナリオをモダン アプリケーション プラットフォームに移動します](./media/why-modern-applications/desktop-to-modern.png)

1. モダン アプリケーションの機能をデスクトップ アプリケーションに移動します。 既存のデスクトップ アプリで、一から書き直すことなくモダン機能を利用する必要がある場合は、モダン アプリケーション プラットフォームの機能がデスクトップ アプリケーションにプッシュされます。

    ![モダン アプリケーションの機能をデスクトップ アプリケーションに移動します](./media/why-modern-applications/modern-to-desktop.png)

本書では、2 番目の部分に注目し、既存のデスクトップ アプリケーションをモダン化する方法について説明します。

## <a name="paths-to-modernization"></a>モダン化へのパス

このガイドの構造には、モダン化を実現するための 3 つの軸が反映されています。モダン機能、デプロイ、およびインストールです。

### <a name="modern-features"></a>モダン機能

たとえば、企業の営業担当者が顧客の注文の入力に使用している、動作している Windows フォーム アプリケーションがあるとします。 顧客がタブレット ペンを使用して注文に署名できるようにするという新しい要件が追加されます。 インクは、現在のオペレーティング システムとテクノロジではネイティブですが、アプリの開発時には利用できませんでした。

このパスでは、モダン デスクトップ機能を既存のデスクトップ開発に活用する方法について説明します。

### <a name="deployment"></a>デプロイ

モダン開発サイクルでは、アプリケーションの新しいバージョンを個々のユーザーにデプロイする方法に機敏性を与えることが重視されてきました。 Windows フォームと WPF のアプリケーションは、コンピューター上に存在する必要がある .NET Framework の特定のバージョンに基づいているため、新しい .NET Framework バージョンの機能を利用するには、IT 担当者の介入が必要になり、同じコンピューターで実行されている他のアプリに対して副作用が生じるリスクもあります。 そのため、開発者は .NET Framework の古いバージョンを使い続けることを強制され、イノベーションの速度が制限されてきました。

.NET Core 3.0 の投入以降は、複数のバージョンの .NET を並行してデプロイし、各アプリケーションでどのバージョンの .NET を対象とするかを指定する、新しいアプローチを利用できます。 こうすることで、他のアプリケーションを破壊しないことを確信しながら、あるアプリケーションで最新の機能を使用することができます。

### <a name="installation"></a>インストール

ユーザーがデスクトップ アプリケーションを使用するには、その前に何らかのインストール プロセスが常に必要です。 そのため、MSI と ClickOnce からカスタム インストーラーや XCOPY によるデプロイまで、一連のテクノロジが利用されています。 これらのいずれの方法でも、アプリケーションからコンピューター上の共有リソースにアクセスする方法が必要になるため、微妙な問題が発生します。 インストールでは、場合により、新しいキー値の挿入または更新のためにレジストリにアクセスしたり、メイン アプリケーションで参照されている共有 DLL を更新したりする必要があります。 この挙動はユーザーにとって継続的な頭痛の種となります。アプリケーションをインストールすると、後でアンインストールしても、コンピューターは元どおりにはならないと感じるためです。

本書では、前述の問題を解決する、MSIX を使用してアプリケーションをインストールする新しい方法を紹介します。 アプリケーションのパッケージ化、インストール、および更新を簡単にセットアップする方法を学習します。

>[!div class="step-by-step"]
>[前へ](index.md)
>[次へ](whats-new-dotnet.md)
